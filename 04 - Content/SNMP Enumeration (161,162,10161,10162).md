---
aliases:
tags:
  - type/cheatsheet
  - technique/recon/passive
  - service/snmp
  - protocol/snmp
  - port/161
  - port/162
  - port/10161
  - port/10162
  - tool/snmpwalk
  - tool/snmp-check
  - tool/nmap
  - tool/onesixtyone
  - meta/community-strings
  - meta/oids
  - meta/default-creds
  - technique/recon/active
primary categories:
  - "[[Penetration Test]]"
secondary categories:
  - "[[Information Gathering]]"
tertiary categories:
  - "[[Host & Network Enumeration]]"
type: CheatSheet
linked:
---
# SNMP Enumeration (161,162,10161,10162)

***

## Cheatsheet

| **Acción**                                                                                               | **Descripción**                                                                                                                                                                                                                                       |
| -------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `sudo nmap -sUV -p 161,162,10161,10162 -v <target>`                                                      | **Ejecuta un escaneo Nmap** sobre el servicio SNMP para identificar su versión (debe ser v1 o v2c).                                                                                                                                                   |
| <br><br><br>`snmpcheck <target>`                                                                         | **Recupera automáticamente información** del servicio SNMP y la muestra de forma organizada. **No reemplaza el escaneo por fuerza bruta.**                                                                                                            |
| `onesixtyone -c /usr/share/seclists/Discovery/SNMP/snmp.txt <target>`                                    | **Realiza un ataque de fuerza bruta** sobre la _community string_ de SNMP.                                                                                                                                                                            |
| `snmpwalk -v <1\|2c\|3> -c <community-string> -oA <target>`                                              | Inicia un escaneo SNMP en un objetivo, comenzando desde la raíz del árbol MIB.                                                                                                                                                                        |
| <br><br><br>`sudo apt install download-mibs`  <br>`snmpwalk ... NET-SNMP-EXTEND-MIB::nsExtendOutputFull` | Instala archivos MIB (incluido NET-SNMP-EXTEND-MIB) y, a continuación, utiliza snmpwalk para enumerar el resultado de scripts o comandos personalizados definidos en el agente SNMP remoto.<br><br>Muy importante, a menudo revela nueva información. |
| `snmpwalk -v <1\|2c\|3> -c <community-string> -oA <target> <OID>`                                        | Realiza un escaneo SNMP en un objetivo, comenzando desde un identificador de objeto (OID) específico.                                                                                                                                                 |

***

## Comunes SNMP OIDs de Windows

|**Objeto**|**OID**|
|---|---|
|Procesos del sistema|`1.3.6.1.2.1.25.1.6.0`|
|Programas en ejecución|`1.3.6.1.2.1.25.4.2.1.2`|
|Ruta de procesos|`1.3.6.1.2.1.25.4.2.1.4`|
|Unidades de almacenamiento|`1.3.6.1.2.1.25.2.3.1.4`|
|Nombre del software|`1.3.6.1.2.1.25.6.3.1.2`|
|Cuentas de usuario|`1.3.6.1.4.1.77.1.2.25`|
|Puertos TCP locales|`1.3.6.1.2.1.6.13.1.3`|

**Consejo:**  Si el objetivo es una máquina Windows, probar estos OIDs antes de hacer fuerza bruta sobre todos los OIDs.
**Nota:**  La bandera `-oA` **traduce automáticamente cualquier cadena hexadecimal a ASCII.**
**Advertencia:**  **Bruteforcear todos los OIDs puede tardar mucho tiempo.**  
Dejá el proceso corriendo en segundo plano durante varios minutos.

***

## Overview

SNMP (**Simple Network Management Protocol**) es un protocolo utilizado para **gestionar y monitorear dispositivos de red** como routers, switches, servidores y impresoras de forma remota.  
No solo permite monitorear el estado y rendimiento de los dispositivos, sino también configurarlos y administrarlos.

Los dispositivos que ejecutan SNMP tienen **agentes de software** instalados que recopilan y proporcionan datos sobre la configuración y el rendimiento del dispositivo cuando son solicitados por los **SNMP managers**.  
La información se organiza jerárquicamente dentro de una **MIB (Management Information Base)**, un archivo estandarizado que define los objetos SNMP disponibles para un dispositivo.  
Cada objeto dentro de esta MIB se identifica mediante un **OID (Object Identifier)**, un código único con estructura jerárquica similar a una dirección IP (por ejemplo: `1.3.6.1.4.1.1.1.0`).

![[Pasted image 20251022171553.png]]



Las **community strings** de SNMP funcionan como **contraseñas en texto plano** que autentican el acceso a los dispositivos con SNMP habilitado:
- La _public community string_ normalmente permite acceso de **solo lectura**.
- La _private community string_ permite **lectura y escritura**, habilitando cambios de configuración.

Sin embargo, **SNMP v1 y v2c no usan cifrado**, por lo que las community strings pueden ser interceptadas y explotadas si la red no es segura.  
La **versión 3 (SNMPv3)** introduce **cifrado y autenticación** para una mayor seguridad.

SNMP utiliza por defecto **UDP**, con:
- **Puerto 161** para enviar comandos.
- **Puerto 162** para recibir _SNMP traps_ (notificaciones de eventos específicos).

Cuando se usa SNMP con **TLS**, los puertos cambian a:
- **10161** (comandos)
- **10162** (traps)

---
